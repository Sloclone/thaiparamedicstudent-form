<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f4f8;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
      margin-bottom: 30px;
    }
    label {
      display: block;
      margin-top: 10px;
      color: #34495e;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      padding: 12px 24px;
      margin-top: 20px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background-color: #2980b9;
    }
    #status {
      margin-top: 20px;
      font-weight: bold;
      color: #27ae60;
    }
  </style>
</head>
<body>
  <h1>üìã ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h1>
  <p id="datetime"></p>
  <form id="dataForm">
    <label>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å <input name="member_id" required></label>
    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å <input name="entry_date" type="date" required></label>
    <label>‡∏ä‡∏∑‡πà‡∏≠ <input name="firstname" required></label>
    <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <input name="lastname" required></label>
    <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô <input name="nickname"></label>
    <label>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î <input name="birthdate" type="date"></label>
    <label>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå <input name="phone"></label>
    <label>Email <input name="email" type="email"></label>
    <label>‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <input name="house_no"></label>
    <label>‡∏´‡∏°‡∏π‡πà <input name="moo"></label>
    <label>‡∏ï‡∏£‡∏≠‡∏Å <input name="alley"></label>
    <label>‡∏ã‡∏≠‡∏¢ <input name="soi"></label>
    <label>‡∏ñ‡∏ô‡∏ô <input name="road"></label>
    <label>‡∏ï‡∏≥‡∏ö‡∏•/‡πÅ‡∏Ç‡∏ß‡∏á <input name="subdistrict"></label>
    <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡πÄ‡∏Ç‡∏ï <input name="district"></label>
    <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <input name="province"></label>
    <label>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå <input name="zipcode"></label>
    <label>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <input name="student_id"></label>
    <label>‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤ <input name="major"></label>
    <label>‡∏Ñ‡∏ì‡∏∞ <input name="faculty"></label>
    <label>‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ <input name="university"></label>
    <label>‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á <input name="photo" type="file" accept="image/*" required></label>
    <button type="submit">üì© ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  </form>
  <div id="status"></div>

  <script>
    document.getElementById("datetime").innerText = new Date().toLocaleString("th-TH", { dateStyle: "full", timeStyle: "medium" });

    document.getElementById("dataForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const status = document.getElementById("status");
      status.innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";

      const form = e.target;
      const formData = new URLSearchParams();

      for (const element of form.elements) {
        if (element.name && element.type !== "file") {
          formData.append(element.name, element.value);
        }
      }

      const fileInput = form.querySelector("input[type='file']");
      const file = fileInput.files[0];
      const reader = new FileReader();

      reader.onloadend = async () => {
        const base64Data = reader.result.split(",")[1];
        formData.append("photo_base64", base64Data);
        formData.append("photo_name", file.name);
        formData.append("photo_type", file.type);

        try {
          const response = await fetch("https://script.google.com/macros/s/AKfycbyGXzIVGCSt0tEZmC9V4PBVJLG5ucrRxLD89aixC7JgjQALFVfyMUO8rcelNQ4WZTvUHg/exec", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: formData.toString()
          });
          const resultText = await response.text();
          status.innerText = resultText;
        } catch (error) {
          status.innerText = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message;
        }
      };

      reader.readAsDataURL(file);
    });
  </script>
</body>
</html>